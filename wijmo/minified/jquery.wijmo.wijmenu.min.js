/*
 *
 * Wijmo Library 2.1.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * licensing@wijmo.com
 * http://www.wijmo.com/license
 *
 **/
(function(a){"use strict";var b="wijmo-wijmenu-item";a.widget("wijmo.wijmenu",{options:{trigger:"",triggerEvent:"click",position:{},animation:{animated:"slide",duration:400,easing:null},showAnimation:{},hideAnimation:{animated:"fade",duration:400,easing:null},showDelay:400,hideDelay:400,slidingAnimation:{duration:400,easing:null},mode:"flyout",superPanelOptions:null,checkable:false,orientation:"horizontal",maxHeight:200,backLink:true,backLinkText:"Back",topLinkText:"All",crumbDefaultText:"Choose an option",select:null,focus:null,blur:null,showing:null},_preventEvent:function(a){a.preventDefault();a.stopImmediatePropagation()},_create:function(){var b=this,g=b.options,h=g.orientation,d=g.mode,k,f,j=b.element,c,i,e=a.ui.keyCode;b.clickNameSpace="click.wijmenudoc"+b._newId();j.hide();b.cssPre="wijmo-wijmenu";b.nowIndex=9999;b.activeItem=null;b.refresh();j.attr("tabIndex",0);g.disabled&&b.disable();j.bind("keydown.wijmenu",function(j){if(g.disabled)return;d==="sliding"&&b.rootMenu.stop(true,true);var l=b.activeItem,m,n,o;if(l)m=b._isRoot(l.parent());else m=true;switch(j.keyCode){case e.PAGE_UP:b.previousPage(j);b._preventEvent(j);break;case e.PAGE_DOWN:b.nextPage(j);b._preventEvent(j);break;case e.UP:if(h==="vertical"||d==="sliding"||!m){b.previous(j);b._preventEvent(j)}break;case e.DOWN:if(h==="vertical"||d==="sliding"||!m){b.next(j);b._preventEvent(j)}else if(l)if(d==="flyout"&&l.has("ul").length>0){c=l.find("ul:first");if(c.is(":hidden")){b._showFlyoutSubmenu(j,l,c);b.activate(j,c.children(".wijmo-wijmenu-item:first"))}}break;case e.RIGHT:if(h==="horizontal"&&m&&d==="flyout"){b.next(j);b._preventEvent(j)}else if(l)if(d==="flyout"&&l.has("ul").length>0){c=l.find("ul:first");if(c.is(":hidden")){b._showFlyoutSubmenu(j,l,c);b.activate(j,c.children(".wijmo-wijmenu-item:first"))}}else if(d==="sliding"){c=l.find("ul:first");if(c.length>0){o=c.children(".wijmo-wijmenu-item:first");l.children(":first").trigger("click",o)}}break;case e.LEFT:if(h==="horizontal"&&m&&d==="flyout"){b.previous(j);b._preventEvent(j)}else{k=l.parent();f=k.parent();if(d==="flyout"){if(f.is("li")){b._hideCurrentSubmenu(f);b.activate(j,f)}}else{g.backLink&&b._backLink&&b._backLink.is(":visible")&&b._backLink.trigger("click",function(){f.is("li")&&b.activate(j,f)});i=a(".wijmo-wijmenu-breadcrumb",b.domObject.menucontainer).find("li a");i.length>0&&i.eq(i.length-2).trigger("click",function(){f.is("li")&&b.activate(j,f)})}}break;case e.ENTER:if(!l)return;n=l.children(":first");if(d==="flyout"){n.focus();n.trigger("click")}else{b.select();n.is("a")&&n.attr("href")==="#"&&b._preventEvent(j)}break;case e.TAB:b.next(j);b._preventEvent(j)}})},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo(a.domObject.menucontainer)}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(){return a("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:"100%",height:"100%",left:0,top:0})},_isRoot:function(a){return this.rootMenu.get(0)===a.get(0)},_destroy:function(){var a=this,b=a.options;a[b.mode==="flyout"?"_killFlyout":"_killDrilldown"]();a._killmenuItems();a._killtrigger();if(a.element.is("ul"))a.element.unwrap().unwrap();else a.element.unwrap();a.element.removeData("domObject").removeData("topmenu").removeData("firstLeftValue")},destroy:function(){var b=this;this._destroy();if(b.disabledDiv){b.disabledDiv.remove();b.disabledDiv=null}a.Widget.prototype.destroy.apply(this)},activate:function(h,f){var a=this,g=a.domObject.scrollcontainer,b=f.eq(0),c,e=false,d=true;if(a.activeItem&&a.activeItem.get(0)===b.get(0))return;c=b.children(":first");a.deactivate(h);a._trigger("focus",h,{item:f});if(a.options.mode==="sliding"){d=b.parent().is(".wijmo-wijmenu-current");e=d&&g.wijsuperpanel("needToScroll",b);if(e){a._linkContainer.link=c;a._linkContainer.needToFocus=true;g.wijsuperpanel("scrollChildIntoView",f)}}b.children(":first").addClass("ui-state-focus").end();a.element.removeAttr("aria-activedescendant");a.element.attr("aria-activedescendant",b.attr("id"));a.activeItem=b;d&&!e&&c.is("a")&&c.focus()},deactivate:function(){var a=this,b=a.activeItem;if(!b)return;b.children(":first").removeClass("ui-state-focus").removeAttr("id");a._trigger("blur");a.activeItem=null},next:function(a){this._move("next","."+b+":first",a)},previous:function(a){this._move("prev","."+b+":last",a)},first:function(){var a=this.activeItem;return a&&!a.prevAll("."+b).length},last:function(){var a=this.activeItem;return a&&!a.nextAll("."+b).length},nextPage:function(f){var b=this,c=b.activeItem,d,h,g,e;if(c)d=c.parent();else{d=b.rootMenu;c=b.rootMenu.children(":first")}if(b.options.mode==="sliding"&&b._hasScroll()){if(!c||b.last()){b.activate(f,d.children(":first"));return}h=c.offset().top;g=b.options.maxHeight;e=d.children("li").filter(function(){var b=a(this),d=g-(b.offset().top-h+b.height()),c=b.height();return d<c&&d>-c});if(!e.length)e=d.children(":last");b.activate(f,e.last())}else b.activate(f,d.children(!c||b.last()?":first":":last"))},previousPage:function(f){var b=this,c=b.activeItem,d,h,g,e;if(c)d=c.parent();else{d=b.rootMenu;c=b.rootMenu.children(":first")}if(b.options.mode==="sliding"&&b._hasScroll()){if(!c||b.first()){b.activate(f,d.children(":last"));return}h=c.offset().top;g=b.options.maxHeight;e=d.children("li").filter(function(){var b=a(this),d=b.offset().top-h+g-b.height(),c=b.height();return d<c&&d>-c});if(!e.length)e=d.children(":first");b.activate(f,e.first())}else b.activate(f,d.children(!c||b.first()?":last":":first"))},select:function(b){var a=this;a._trigger("select",b,{item:a.activeItem});a._setCheckable()},setItemDisabled:function(d,b){var c=a(d,this.element);c.find(".wijmo-wijmenu-item>a").attr("disabled",b);c.find(">a").toggleClass("ui-state-disabled",b)},_setCheckable:function(){this.options.checkable&&this.activeItem.children(":first").toggleClass("ui-state-active")},_setOption:function(a,b){var c=this;this["_set_"+a]&&this["_set_"+a](b);this.options[a]=b;a==="disabled"&&c._handleDisabledOption(b,c.domObject.menucontainer)},_set_mode:function(a){this._destroy();this.options.mode=a;this.refresh()},_set_orientation:function(d){var b=this,c=b.domObject.menucontainer;c.removeClass(b.cssPre+"-vertical "+b.cssPre+"-horizontal");if(b.options.mode==="flyout"){c.addClass(b.cssPre+"-"+d);a(">li:has(ul)",b.rootMenu).each(function(){var b="ui-icon-triangle-1-",e=d==="horizontal"?"e":"s",c=d==="horizontal"?"s":"e";a(">.wijmo-wijmenu-link",this).find("."+b+e).removeClass(b+e+" "+b+c).addClass(b+c)})}else c.addClass(b.cssPre+"-vertical")},_getTriggerEle:function(){return a(this.options.trigger).filter(function(){return a(this).closest(".wijmo-wijmenu").length===0})},_set_triggerEvent:function(d){var a=this,c=a.options,b=a._getTriggerEle();a._killtrigger();c.triggerEvent=d;b.length>0&&a._initTrigger(b);if(c.mode==="flyout"){a._killFlyout();a._flyout()}},_set_trigger:function(d){var a=this,c=a.options,b=a._getTriggerEle();a._killtrigger();c.trigger=d;b.length>0&&a._initTrigger(b);if(c.mode==="flyout"){a._killFlyout();a._flyout()}},_initTrigger:function(b){var g=this.options,f=g.triggerEvent,d=this,c=d.domObject.menucontainer,e=".wijmenu";if(b.is("iframe"))b=a(b.get(0).contentWindow.document);switch(f){case"click":b.bind(f+e,function(a){g.mode!=="popup"&&d._displaySubmenu(a,b,c)});break;case"mouseenter":b.bind(f+e,function(a){d._displaySubmenu(a,b,c)});break;case"dblclick":b.bind(f+e,function(a){d._displaySubmenu(a,b,c)});break;case"rtclick":b.bind("contextmenu"+e,function(a){c.hide();d._displaySubmenu(a,b,c);a.preventDefault()})}},_killtrigger:function(){var c=this.options,b;if(c.trigger!==""){b=a(c.trigger);if(b.is("iframe"))b=a(b.get(0).contentWindow.document);b&&b.length>0&&b.unbind(".wijmenu")}},_move:function(h,g,d){var c=this.activeItem,e,f;if(!c){this.activate(d,this.rootMenu.children(g));return}e=a(c)[h+"All"]("."+b).eq(0);f=c.parent();if(e.length)this.activate(d,e);else this.activate(d,f.children(g))},refresh:function(){var c=this,g=c.element,e="wijmo-wijmenu",d=c.options,h,f,l,i,k,n=e+"-separator ui-state-default ui-corner-all",p="ui-widget-header ui-corner-all",j="ui-widget "+b+" ui-state-default ui-corner-all",o=e+"-link ui-corner-all",m=e+"-template";c.domObject&&c._destroy();if(g.is("ul")){c.rootMenu=g;h=g.wrap("<div></div>").parent();f=h.wrap("<div></div>").parent()}else if(g.is("div")){c.rootMenu=a("ul:first",g);h=g;f=g.wrap("<div></div>").parent()}h.addClass("scrollcontainer checkablesupport");f.addClass("ui-widget ui-widget-header "+e+" ui-corner-all ui-helper-clearfix").attr("aria-activedescendant","ui-active-menuitem");d.orientation==="horizontal"&&d.mode==="flyout"&&f.addClass(e+"-"+d.orientation);l={scrollcontainer:h,menucontainer:f};c.domObject=l;c.rootMenu.data("topmenu",true);!c.rootMenu.hasClass(e+"-list ui-helper-reset")&&c.rootMenu.addClass(e+"-list ui-helper-reset");a("li",c.rootMenu).each(function(k,i){var h=a(">ul:first",i).length>0,f=a(i),g,c=a(">:first",f);if(c.length===0)f.addClass(n);else{f.attr("role","menuitem");if(c.is("a")){c.bind("mouseenter.wijmenuitem",function(){var b=c.hasClass("ui-state-disabled");if(d.disabled||b)return;a(this).addClass("ui-state-hover")}).bind("mouseleave.wijmenuitem",function(){var b=c.hasClass("ui-state-disabled");if(d.disabled||b)return;a(this).removeClass("ui-state-hover");a(this).data("subMenuOpened")&&a(this).addClass("ui-state-active")});if(!f.hasClass(b)){f.addClass(j);c.addClass(o);c.wrapInner("<span>").children("span").addClass(e+"-text");if(h){g=a("<span>").addClass("ui-icon ui-icon-triangle-1-e");c.append(g)}}}else if(c.is("h1,h2,h3,h4,h5"))f.addClass(p);else{f.addClass(j);c.addClass(m);if(h)if(!c.is(":input")){g=a("<span>").addClass("ui-icon ui-icon-triangle-1-e");c.append(g)}}}});g.show();a("ul",c.rootMenu).each(function(){a(this).addClass(e+"-list ui-widget-content ui-corner-all ui-helper-clearfix "+e+"-child ui-helper-reset");a(this).hide()});this[d.mode==="flyout"?"_flyout":"_drilldown"]();if(d.trigger!==""){i=c._getTriggerEle();if(i.length>0){f.hide();c._initTrigger(i)}}a(document).bind(c.clickNameSpace,function(b){if(a(b.target).parent().is(".wijmo-wijmenu-all-lists"))return;if(a(b.target).closest(d.trigger).is(d.trigger))return;var e=a(b.target).closest(".wijmo-wijmenu");if(e.length===0){if(d.mode==="sliding"){k=a(".wijmo-wijmenu-breadcrumb",f);if(d.trigger==="")return;c._resetDrilldownMenu(k)}else if(d.mode==="flyout"&&d.triggerEvent!=="mouseenter"){c._hideAllMenus();return}i&&i.length>0&&c._hideSubmenu(f)}})},_showFlyoutSubmenu:function(f,d,e){var c=this,b=c.currentMenuList,a;if(b!==undefined)for(a=b.length;a>0;a--)if(b[a-1].get(0)===d.parent().get(0))break;else c._hideSubmenu(b[a-1]);c._displaySubmenu(f,d.find(".wijmo-wijmenu-link:eq(0)"),e)},_getItemTriggerEvent:function(d){var e=this,b=e.options,c="default",f;if(b.trigger!=="")if(d.is(b.trigger)||e.element.is(b.trigger))c=b.triggerEvent;else{d.parents(".wijmo-wijmenu-parent").each(function(e,d){if(a(d).is(b.trigger)){c=b.triggerEvent;return false}});if(c==="default"){f=e._getTriggerEle();if(f.length>0)c=b.triggerEvent}}d.data("triggerEvent",c);return c},_flyout:function(){var b=this,g=b.domObject.menucontainer,c=b.options,d="wijmo-wijmenu-link",j="wijmo-wijmenu-template",h="ui-icon-triangle-1-e",i="ui-icon-triangle-1-s",e="wijmo-wijmenu-parent",f;g.attr("role","menu");if(c.orientation==="horizontal"){g.attr("role","menubar");b.rootMenu.children("li:has(ul)").each(function(){a(this).children("."+d).find("."+h).removeClass(h).addClass(i)})}g.find("li:has(ul)").each(function(){var h=".wijmenu",g=a(this).attr("aria-haspopup",true),l,k,m=b._getItemTriggerEvent(g),f,i;g.children("ul").bind("mouseleave."+h,function(){if(c.disabled)return;var d=a(this).parent();k=setTimeout(function(){b._hideCurrentSubmenu(d)},c.hideDelay)});if(m!=="default"&&c.triggerEvent!=="mouseenter"){g.removeClass(e).addClass(e);f=a(this).find("."+d+":eq(0)");i=f.next();switch(c.triggerEvent){case"click":f.bind("click"+h,function(d){if(c.disabled||a(this).hasClass("ui-state-disabled"))return;b._showFlyoutSubmenu(d,g,i)});break;case"dblclick":f.bind("dblclick"+h,function(d){if(c.disabled||a(this).hasClass("ui-state-disabled"))return;b._showFlyoutSubmenu(d,g,i)});break;case"rtclick":f.bind("contextmenu"+h,function(d){if(c.disabled||a(this).hasClass("ui-state-disabled"))return;b._showFlyoutSubmenu(d,g,i);d.preventDefault()})}i.data("notClose",true)}else{g.removeClass(e).addClass(e);f=a(this).find("."+d+":eq(0)");f.bind("mouseenter.wijmenu",function(f){if(c.disabled||a(this).hasClass("ui-state-disabled"))return;clearTimeout(k);var d=a(this).next(),e=a(this);l=setTimeout(function(){b._displaySubmenu(f,e,d)},c.showDelay)}).bind("mouseleave"+h,function(){if(c.disabled||a(this).hasClass("ui-state-disabled"))return;clearTimeout(l);var d=a(this).next();if(!d.is("ul"))d=d.children("ul:first");k=setTimeout(function(){b._hideSubmenu(d)},c.hideDelay)});a(this).find("ul ."+d+", ul ."+j+",ul >.ui-widget-header,ul >.wijmo-wijmenu-separator").bind("mouseenter"+h,function(){if(c.disabled)return;clearTimeout(k)})}});g.find("."+d).bind("click.wijmenu",function(h){f=a(this).hasClass("ui-state-disabled");if(c.disabled||f)return;if(a(this).is("a")){if(a(this).parent().find("ul").length===0)b._hideAllMenus();else if(!(c.trigger!==""&&a(this).parent().data("triggerEvent")!=="default"&&c.triggerEvent!=="mouseenter"))b._hideAllMenus();else{var e=b.currentMenuList,g,d;if(e!==undefined){g=a(this).parent();if(g.has("ul").length===0)for(d=e.length;d>0;d--)if(e[d-1].get(0)===g.parent().get(0))break;else b._hideSubmenu(e[d-1])}}b.activate(h,a(this).parent())}b.select(h);a(this).attr("href")==="#"&&h.preventDefault()}).bind("focusin",function(d){f=a(this).hasClass("ui-state-disabled");if(c.disabled||f)return;a(this).is("a")&&b.activate(d,a(this).parent())})},_hideAllMenus:function(){var b=this,f,e,c,d,g=b.rootMenu;d=g.find("ul");for(c=d.length-1;c>=0;c--)b._hideSubmenu(a(d[c]));if(b.options.trigger!==""){f=b.domObject.menucontainer;if(f.is(":animated"))return;e=b._getTriggerEle();if(e.length===0)return;b._hideSubmenu(b.domObject.menucontainer)}},hideAllMenus:function(){this._hideAllMenus()},_killFlyout:function(){var b=this.domObject.menucontainer.attr("role","");b.find("li").each(function(){a(this).removeClass("wijmo-wijmenu-parent").unbind(".wijmenu").children(":first").unbind(".wijmenu").attr("aria-haspopup","")})},_killmenuItems:function(){var c=this,d=c.rootMenu;d.removeClass("wijmo-wijmenu-list ui-helper-reset wijmo-wijmenu-content ui-helper-clearfix");d.find("li").each(function(){var c=a(this),d;c.removeClass("ui-widget "+b+" ui-state-default ui-corner-all wijmo-wijmenu-parent ui-widget-header wijmo-wijmenu-separator");d=c.children(".wijmo-wijmenu-link");d.removeClass("wijmo-wijmenu-link ui-corner-all ui-state-focus ui-state-hover ui-state-active").html(d.children(".wijmo-wijmenu-text").html()).unbind(".wijmenu .wijmenuitem");c.children("ul").removeClass("wijmo-wijmenu-list ui-widget-content ui-corner-all ui-helper-clearfix wijmo-wijmenu-child ui-helper-reset").attr("role","").attr("aria-activedescendant","").show().css({left:"",top:"",position:""}).attr("hidden","")});this.domObject.menucontainer.removeClass("");a(document).unbind(c.clickNameSpace)},_sroll:function(){var a=this.domObject.scrollcontainer,b=this.options.superPanelOptions||{};a.height(this.options.maxHeight);a.wijsuperpanel(b)},_initScrollCallback:function(){var a=this,b=a.domObject.scrollcontainer;a._linkContainer={link:null,needToFocus:false};b.wijsuperpanel({scrolled:function(){var b=a._linkContainer.link;if(a._linkContainer.needToFocus&&b&&b.is("a")){b.focus();a._linkContainer.needToFocus=false}}})},_hasScroll:function(){var a=this.domObject.scrollcontainer;return a.data("wijsuperpanel").vNeedScrollBar},_resetDrillChildMenu:function(a){a.removeClass("wijmo-wijmenu-scroll wijmo-wijmenu-current").height("auto")},_checkDrillMenuHeight:function(b,c,a){var e=this,d=5;c.height(b.height());a.wijsuperpanel("option","hScroller",{scrollValue:0});a.wijsuperpanel("option","vScroller",{scrollValue:0});a.wijsuperpanel("paintPanel");if(e._hasScroll()){if(b.prev().length>0)d=b.prev().css("padding-left").replace(/px/g,"");b.width(a.find(".wijmo-wijsuperpanel-contentwrapper:first").width()-d);c.height(b.height());a.wijsuperpanel("paintPanel")}},_resetDrilldownMenu:function(i,e){var b=this,f=b.options,c=b.rootMenu,d=b.domObject.menucontainer,g=a('<li class="wijmo-wijmenu-breadcrumb-text">'+f.crumbDefaultText+"</li>"),h=c.parent();a(".wijmo-wijmenu-current",d).removeClass("wijmo-wijmenu-current");c.animate({left:0},f.showDuration,function(){e&&e();a(this).find("ul").each(function(){a(this).hide();b._resetDrillChildMenu(a(this))});c.addClass("wijmo-wijmenu-current")});a(".wijmo-wijmenu-all-lists",d).find("span").remove();i.empty().append(g);a(".wijmo-wijmenu-footer",d).empty().hide();b._checkDrillMenuHeight(c,h,b.domObject.scrollcontainer)},_drilldown:function(){var b=this,d=b.rootMenu,i=d.wrap("<div>").parent().css("position","relative"),e=b.domObject.menucontainer.attr("role","menu"),h=b.domObject.scrollcontainer,c=b.options,g,f=a('<ul class="wijmo-wijmenu-breadcrumb ui-state-default ui-corner-all ui-helper-clearfix"></ul>'),l=a('<li class="wijmo-wijmenu-breadcrumb-text">'+c.crumbDefaultText+"</li>"),o=c.backLink?c.backLinkText:c.topLinkText,m=c.backLink?"wijmo-wijmenu-prev-list":"wijmo-wijmenu-all-lists",k=c.backLink?"ui-state-default ui-corner-all":"",n=c.backLink?'<span class="ui-icon ui-icon-triangle-1-w"></span>':"",j=a('<li class="'+m+'"><a href="#" class="'+k+'">'+n+o+"</a></li>");e.addClass("wijmo-wijmenu-ipod wijmo-wijmenu-container");if(c.backLink)f.addClass("wijmo-wijmenu-footer").appendTo(e).hide();else f.addClass("wijmo-wijmenu-header").prependTo(e);!c.backLink&&f.append(l);d.addClass("wijmo-wijmenu-content wijmo-wijmenu-current ui-widget-content ui-helper-clearfix").css({width:e.width()}).find("ul").css({width:e.width(),left:e.width()}).addClass("ui-widget-content");b._sroll();b._initScrollCallback();b._checkDrillMenuHeight(d,i,h);b.element.data("firstLeftValue",parseFloat(d.css("left")));a("li>.wijmo-wijmenu-link",d).each(function(){if(a(this).next().is("ul")){g=a(this).parent().attr("disabled");a(this).click(function(n,l){if(c.disabled||g)return;d.stop(true,true);var r=a(this).next(),s=a(this).parents("ul:eq(0)"),p=s.data("topmenu")?0:parseFloat(d.css("left")),q,m,t=Math.round(p-parseFloat(e.width())),k=a(".wijmo-wijmenu-footer",e),o=function(f){var g=f,d=a(".wijmo-wijmenu-current",e),c;if(d.get(0)===b.rootMenu.get(0))return;c=d.parents("ul:eq(0)");d.hide().attr("aria-expanded","false");b._resetDrillChildMenu(d);b._checkDrillMenuHeight(c,i,h);c.addClass("wijmo-wijmenu-current").attr("aria-expanded","true");if(c.hasClass("wijmo-wijmenu-content")){g.remove();k.hide()}};b._resetDrillChildMenu(s);b._checkDrillMenuHeight(r,i,h);l=l||a(this).parent();b._slidingAnimation(d,t,function(){b.activate(n,a(l));b.select(n)});r.show().addClass("wijmo-wijmenu-current").attr("aria-expanded","true");if(c.backLink){if(k.find("a").size()===0){k.show();b._backLink=a('<a href="#"><span class="ui-icon ui-icon-triangle-1-w"></span> <span>'+c.backLinkText+"</span></a>").appendTo(k).click(function(i,g){if(c.disabled)return;var h=a(this),f;d.stop(true,true);f=parseInt(d.css("left"),10)+parseInt(e.width(),10);if(f>p)return;b._slidingAnimation(d,f,function(){g&&g();o(h)});i.preventDefault()})}}else{if(f.find("li").size()===1){f.empty().append(j);j.find("a").click(function(c,a){b._resetDrilldownMenu(f,a);c.preventDefault()})}a(".wijmo-wijmenu-current-crumb",e).removeClass("wijmo-wijmenu-current-crumb");q=a(this).find("span:eq(0)").text();m=a('<li class="wijmo-wijmenu-current-crumb"><a href="#" class="wijmo-wijmenu-crumb">'+q+"</a></li>");m.appendTo(f).find("a").click(function(g,e){if(c.disabled)return;d.stop(true,true);if(!a(this).parent().is(".wijmo-wijmenu-current-crumb")){var f=-(a(".wijmo-wijmenu-current").parents("ul").size()-1)*180;b._slidingAnimation(d,f,function(){o();e&&e()});a(this).parent().addClass("wijmo-wijmenu-current-crumb").find("span").remove();a(this).parent().nextAll().remove();g.preventDefault()}});m.prev().append(' <span class="ui-icon ui-icon-carat-1-e"></span>')}a(this).attr("href")==="#"&&n.preventDefault()})}else a(this).click(function(d){g=a(this).parent().attr("disabled");if(c.disabled||g)return;b.activate(d,a(this).parent());b.select(d);if(c.trigger){var h=b._getTriggerEle();if(h.length){b._hideSubmenu(e);b._resetDrilldownMenu(f)}}a(this).attr("href")==="#"&&d.preventDefault()})})},_slidingAnimation:function(d,c,b){var a=this.options.slidingAnimation;if(a&&!a.disabled)d.stop(true,true).animate({left:c},a.duration,a.easing,b);else{d.css("left",c);b.call(this)}},_killDrilldown:function(){var c=this.rootMenu,b=this.domObject,d={width:"",height:""};c.css(d).removeClass("ui-widget-content");b.scrollcontainer.css(d);b.scrollcontainer.wijsuperpanel("destroy");b.scrollcontainer.removeClass("wijmo-wijsuperpanel").append(c);c.prevAll().remove();b.menucontainer.removeClass("wijmo-wijmenu-ipod wijmo-wijmenu-container");a(".wijmo-wijmenu-current",b.menucontainer).removeClass("wijmo-wijmenu-current");a(".wijmo-wijmenu-breadcrumb",b.menucontainer).remove();c.find("li").each(function(){var b=a(this).children(":first");b.unbind("click")});a("ul",c).css({left:"",width:""});c.css("left","");b.scrollcontainer=b.menucontainer.children(":first")},_getItemByValue:function(c){var b=this.rootMenu.find("a.wijmo-wijmenu-link").filter(function(){return a(this).text()===c});return b.length>0?b.eq(0).parent():null},_displaySubmenu:function(j,f,b){var c=this,d=c.options,g,e,h,i=a.wijmo.wijmenu.animations;f.is("a.wijmo-wijmenu-link")&&f.data("subMenuOpened",true);if(b.is(":visible"))return;b.show();c._setPosition(f,b);c.nowIndex++;c._setZindex(b,c.nowIndex);b.hide();c._trigger("showing",j,b);if(a.fn.wijshow){g={context:b,show:true};e="left";if(d.orientation==="horizontal")if(b.parent().closest("ul").get(0)===this.rootMenu.get(0))e="up";h=a.extend({},{option:{direction:e}},d.animation,d.showAnimation);b.wijshow(h,i,g,null,function(){var d=a.browser;if(d.msie&&d.version==="9.0"){b.wrap("<div></div>");b.unwrap()}else d.msie&&d.version==="6.0"&&b.css("overflow","");b.attr("aria-hidden",false);b.is(":hidden")&&c._hideSubmenu(b,true)})}else b.show().attr("aria-hidden",false);c._isClickToOpen=d.triggerEvent==="click";if(!b.is(".wijmo-wijmenu")){if(c.currentMenuList===undefined)c.currentMenuList=[];c.currentMenuList.push(b)}},_hideCurrentSubmenu:function(b){var c=this;b.find("ul").each(function(){!a(this).data("notClose")&&c._hideSubmenu(a(this))})},_hideSubmenu:function(b,h){var d=this,g=d.options,i=a.wijmo.wijmenu.animations,e,c,f;if(b.prev().is(".wijmo-wijmenu-link")){b.prev().data("subMenuOpened",false);b.prev().removeClass("ui-state-active")}if(a.fn.wijhide&&h!==true){e={context:b,show:false};f=a.extend({},g.animation,g.hideAnimation);b.wijhide(f,i,e,null,function(){d._setZindex(b);b.attr("aria-hidden",true)})}else{b.hide().attr("aria-hidden",true);d._setZindex(b)}this.element.data("shown",false);c=this.currentMenuList;if(c){c=a.map(c,function(a){return a&&a.get(0)===b.get(0)?null:a});this.currentMenuList=a.makeArray(c)}},_setZindex:function(c,d){var f=this.rootMenu,e=this.domObject,b;if(!e)return;b=e.menucontainer;if(c.get(0)===b.get(0)){if(d)b.css("z-index",d);else b.css("z-index","");return}if(d){c.parent().css("z-index",999);c.css("z-index",d);a.browser.msie&&a.browser.version<8&&b.css("z-index")===0&&b.css("z-index",9950)}else{c.css("z-index","");c.parent().css("z-index","");a.browser.msie&&a.browser.version<8&&a("ul:visible",f).length===0&&b.css("z-index")===9950&&b.css("z-index","")}},_setPosition:function(c,b){b.css({left:"0",top:"0",position:"absolute"});var d=this._getPosition(c),e={of:c};b.position(a.extend(e,d))},_getPosition:function(c){var d=this.options,b={my:"left top",at:"right top"};if(d.orientation==="horizontal")if(c.closest("ul").get(0)===this.rootMenu.get(0))b={my:"left top",at:"left bottom"};if(!c.is(".wijmo-wijmenu-link"))b={my:"left top",at:"left bottom"};b=a.extend(b,d.position);return b},_newId:function(){for(var c=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a="",b=0;b<16;b++)a+=c[Math.round(Math.random()*25)];return a}});a.extend(a.wijmo.wijmenu,{animations:{slide:function(b,c){b=a.extend({duration:400,easing:"swing"},b,c);if(b.show)b.context.stop(true,true).animate({height:"show"},b).attr("aria-hidden",false);else b.context.stop(true,true).animate({height:"hide"},b).attr("aria-hidden",true)}}})})(jQuery);